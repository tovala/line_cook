version: 2

models:
  - name: tovala_meal_cook_events
    data_tests:
      - expression_is_true:
          arguments:
            expression: 'NOT (meal_sku_id IS NULL AND add_on_id IS NULL)'
            name: 'meal_sku_id_or_add_on_id_is_present'
    columns:      
      - name: cook_event_id
        data_tests:
          - primary_key
      - name: cook_end_type
        data_tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['cook_completed', 'cook_canceled', 'unknown_termination']
      - name: subroutine
        data_tests:
          - accepted_values:
              arguments:
                values: ['A', 'B', 'C', 'D', 'U']
          # There was an error where 'U' was coming through as a subroutine, but it should only happen in the given timeframe
          - expression_is_true:
              arguments:
                expression: "IN ('A', 'B', 'C', 'D')"
                condition: "cook_start_time > '2024-04-01'"