version: 2

models:
  - name: oven_orders
    description: "Table of D2C oven orders."
    data_tests:
      # Non-free ovens should have a referenceable payment (either internal or affirm)
      - expression_is_true:
          arguments:
            expression: "COALESCE(payment_id, affirm_charge_id) IS NOT NULL"
            condition: "NOT is_free_oven AND order_time > '2020-01-01'"
    columns:
      - name: oven_order_id
        description: "Primary Key (hashed natural key)"
        data_tests:
          - primary_key
      - name: order_time
        description: "Time (in UTC) at which oven was ordered"
        data_tests:
          - not_null
      - name: status
        data_tests:
          - not_null 
      - name: first_orderable_term_id
        data_tests:
          - not_null
      - name: oven_order_sku_formatted
        data_tests:
          - not_null