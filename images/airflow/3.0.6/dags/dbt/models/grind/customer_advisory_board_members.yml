version: 2
models:
  - name: customer_advisory_board_members
    description: 'Tracks CAB membership at customer level'
    data_tests:
      #  Make sure cab start date is smaller than cab left date
      - expression_is_true: 
          arguments:
            expression: "DATEDIFF('days', membership_start_date, COALESCE(membership_end_date, '9999-12-13')) >=0"
    columns:
      - name: customer_id
        data_tests:
          - primary_key
      - name: has_signed_nda 
        test:
          - not_null
      - name: is_slackable 
        test:
          - not_null  
      - name: membership_start_date
        data_tests:
          - not_null