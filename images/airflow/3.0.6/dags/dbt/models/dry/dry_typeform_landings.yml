version: 2

models:
  - name: dry_typeform_landings
    columns:
      - name: token
        data_tests:
          - primary_key
      - name: landing_id
        data_tests:
          - primary_key
      - name: submitted_at
        data_tests:
          - not_null:
              arguments:
                where: "COALESCE(response_type, 'completed') = 'completed'"
      - name: response_type
        data_tests:
          - not_null:
              arguments:
                where: "landed_at > '2023-11-25'"
          - accepted_values:
              arguments:
                values: ["partial", "completed"]
