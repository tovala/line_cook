version: 2

models:
  - name: break_skip_events
    description: "Splits breaks records into distinct records by term."
    data_tests:
      # There should only ever be one record per customer & term where the end is NULL
      - unique_columns:
          arguments:
            unique_column_list:
              - customer_id
              - term_id
            where_clause: "unbreak_time IS NULL"
      - no_overlapping_rows:
          arguments:
            start_field: break_time
            end_field: unbreak_time 
            column_join_list:
              - customer_id
              - term_id
    columns:
      - name: skip_id
        data_tests:
          - primary_key
      - name: term_id
        data_tests:
          - not_null