version: 2

models:
  - name: oven_logs
    columns:
      - name: filename
        data_tests:
          - not_null
      - name: updated
        data_tests:
          - not_null
      - name: raw_data
        data_tests:
          # If this is NULL, it indicates incorrect data coming through the oven log pipeline
          - expression_is_true:
              arguments:
                expression: IS NOT NULL
                # Running on subset of data for efficiency
                condition: "UPDATED::DATE >= DATEADD('days', -2, {{ current_timestamp_utc() }}::DATE)"